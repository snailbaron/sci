\documentclass{article}
\usepackage[english,russian]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1,T2A]{fontenc}
\usepackage{amsmath}
\usepackage{amssymb}

\title{О вероятностных свойствах деревьев вывода для разложимой стохастической КС-грамматики, имеющей вид <<цепочки>>}
\author{Л.П.~Жильцова, И.М.~Мартынов (Нижний Новгород)}
\date{}

\newtheorem{theorem}{Теорема}

\begin{document}
\maketitle

В работе исследуются вероятностные свойства деревьев вывода высоты $t$ при $t \rightarrow \infty$ для стохастической КС-грамматики специального вида. Рассматривается случай, когда матрица первых моментов $A$ грамматики разложима и имеет перронов корень равный $1$. Целью работы ялвляется обобщение результатов, полученных в \cite{borisov-disser}, на случай неограниченного числа классов нетерминалов.

Стохастической КС--грамматикой называется система $G = \left< V_N, V_N, R, s \right>$, где $V_T$ и $V_N$ --- конечные алфавиты терминальных и нетерминальных символов соответственно, $s \in V_N$ --- аксиома, $R = \cup_{i = 1}^k R_i$, где $k$ --- мощность алфавита $V_N$ и $R_i$ --- множество правил с одинкаовой левой частью вида
\begin{equation*}
    r_{ij} : A_i \xrightarrow{p_{ij}} \beta_{ij},\;j = 1,2,\ldots,n,
\end{equation*}
где $A_i \in V_N$, $\beta_{ij} \in (V_T \cup V_N)^*$ и $p_{ij}$ --- вероятность применения правила $r_{ij}$, причём $0 < p_{ij} \leqslant 1$ и $\sum_{j = 1}^{n_i} p_{ij} = 1$.

Применение правила грамматики к слову состоит в замене вхождения нетерминала из левой части правила на слово, стоящее в его правой части.

Каждому слову $\alpha$ КС-языка соответствует последовательность правил грамматики (вывод), с помощью которой $\alpha$ выводится из аксиомы $s$. Выводу слова соответствует дерево вывода, вероятность которого определяется как произведение вероятностей правил, образующих вывод.

По стохастической КС-грамматике строится матрица $A$ первых моментов. Для неё элемент $a^i_j$ определяется как $\sum_{l = 1}^{n_i} p_{il} s_{il}^j$, где величина $s_{il}^j$ равна числу нетерминальных символов $A_j$ в правой части правила $r_{il}$. Перронов корень матрицы $A$ обозначим через $r$.

Введём некоторые обозначения. Будем говорить, что нетерминал $A_j$ непосредственно следует за нетерминалом $A_i$ (и обозначать $A_i \rightarrow A_j$), если в грамматике существует правило вида $A_i \xrightarrow{p_{il}} \alpha_1 A_j \alpha_2$, где $\alpha_1, \alpha_2 \in (V_T \cup V_N)^*$. Рефлексивное транзитивное замыкание отношения $\rightarrow$ обозначим $\rightarrow_*$.

Классом нетерминалов назовём максимальное по включению подмножество $K \in V_N$ такое, что $A_i \rightarrow_* A_j$ для любых $A_i, A_j \in K$. Для различных классов нетерминалов $K_1$ и $K_2$ будем говорить, что класс $K_2$ непосредственно следует за классом $K_1$ (и обозначать $K_1 \prec K_2$), если существуют $A_1 \in K_1$ и $A_2 \in K_2$, такие, что $A_1 \rightarrow A_2$. Рефлексивное транзитивное замыкание отношения $\prec$ обозначим через $\prec_*$.

Пусть $\mathfrak{K} = \{ K_1, K_2, \ldots, K_m \}$ --- множество классов нетерминалов грамматики, $m \geqslant 2$. Будем полагать, что классы нетерминалов перенумерованы таким образом, что $K_i \prec K_j$ тогда и только тогда, когда $i < j$.

Будем говорить, что грамматика имеет вид <<цепочки>>, если её матрица первых моментов $A$ имеет вид
\begin{equation}
\label{eq:matrix}
    A = 
    \begin{pmatrix}
        A_{11} & A_{12} & 0 & \cdots & 0 & 0 \\
        0 & A_{22} & A_{23} & \cdots & 0 & 0 \\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & 0 & \cdots & A_{n-1,n-1} & A_{n-1,n} \\
        0 & 0 & 0 & \cdots & 0 & A_{n,n}
    \end{pmatrix}
\end{equation}
Один класс нетерминалов представлен в матрице множеством подряд идущих строк и соответствующим множеством столбцов с теми же номерами. Для класса $K_i$ квадратная подматрица, образованная соответствующими строками и столбцами, обозначается через $A_{ii}$. Подматрица $A_{ij}$ является нулевой, если $K_i \nprec K_j$. Блоки, расположенные ниже главной диагонали, нулевые в силу упорядоченности классов.

Для каждого класса $K_i$ матрица $A_{ii}$ неразложима. Без ограничения общности будем считать, что она строго положительна и непериодична. Обозначим через $r_i$ перронов корень матрицы $A_{ii}$. Для неразложимой матрицы перронов корень является вещественным и простым \cite{gantmaher}. Очевидно, $r = \max_i \{ r_i \}$.

Пусть $J = \{ i_1, i_2, \ldots, i_l \}$ --- множество всех номеров $i_j$ классов, для которых $r_{ij} = 1$.

Рассмотрим всевозможные подцепочки классов $K_\mu, K_{\mu+1}, \ldots, K_\nu$. Число классов с номерами из $J$ в такой подцепочке обозначим через $s_{\mu \nu}$. Обозначим, кроме того, $q_j = s_{jm}$.

Через $P_j(t)$ обозначим вероятность множества деревьев вывода высоты $t$, корень которых помечен нетерминалом $A_j$.

\begin{theorem}
	Пусть $r_j=1.$ Тогда при $t \rightarrow \infty$ 
	\begin{equation*}
		P_j(t)\sim U^{(j)} \cdot \frac {c_j}{ t^{1+\left(\frac{1}{2}\right)^{q_j-1}}},  
	\end{equation*}
	где $U^{(j)}$ - правый собственный вектор для матрицы $A_{ii}$ из $(\ref{eq:matrix})$, соответствующий $r_j,$ 
	и $c_j$ - некоторая константа.
\end{theorem}

\begin{theorem}
	Пусть $r_j<1.$ Тогда при $t \rightarrow \infty$ 
	\begin{equation*}
		P^{(j)}(t)\sim U^{(j)} \cdot \frac {1}{ t^{1+\left(\frac{1}{2}\right)^{q_j-1}}},  
	\end{equation*}
	
	\begin{equation*}
		\mbox{где}\, \, \,  U^{(j)}= \left(E-A_{jj}\right)^{-1}\sum_l A_{jl}U^{(l)}\cdot c_l,
	\end{equation*}
	где суммирование ведется по всем номерам $l$ классов с $r_l=1$ таких, что $K_j \prec_* K_l$ и $q_l=q_j-1.$
\end{theorem}

Здесь $c_l$ и $U^{(l)}$ имеют тот же смысл, что и в теореме 1.

\begin{theorem}
    Пусть грамматика имеет вид <<цеопчки>>, и $r_j = 1$ для любого $j \in \{1,2,\ldots,m\}$. Пусть, кроме этого, в грамматике имеется некоторое правило $r_{ij}$, такое что $A_i \in K_\nu$. Тогда при $t \rightarrow \infty$ математическое ожидание числа применений правила $r_{ij}$ в деревьях вывода высоты $t$ выражается следующим образом:
    \begin{equation}
        M_{ij}(t) = \mathcal{M} u^{(1)}_1 \cdot t^{ \left( \frac{1}{2} \right)^{m - \nu - 1} } (1 + o(1)),
    \end{equation}
    где $\mathcal{M}$ --- некоторая константа, и $u^{(1)}_1$ --- первая компонента правого собственного вектора матрицы $A_{11}$.
\end{theorem}

Таким образом, в цепочке, полностью состоящей из критических классов, асимптотика определяется удалённостью класса, в котором может применяться искомое правило ($K_\nu$ в обозначениях теоремы), от последнего класса цепочки. Если класс $K_\nu$ значительно удалён от конца цепочки, искомое правило применяется реже, так как высота $t$ дерева вывода достигается в большей степени за счёт применения правил из последующих классов. При приближении $K_\nu$ к концу цепочки, искомое правило применяется чаще, в силу большей разветвлённости дерева вывода ближе к его листьям, и большего содержания в нём нетерминалов из $K_\nu$.

\begin{theorem}
    Пусть в грамматике, имеющей вид <<цепочки>> имеется некоторое правило $r_{ij}$ такое, что $A_i \in K_\nu$ и $\nu \in J$. Тогда при $t \rightarrow \infty$ математическое ожидание числа пременений правила $r_{ij}$ в деревьях вывода высоты $t$ выражается следующим образом:
    \begin{equation}
        M_{ij}(t) = \mathcal{M} U^{(1)}_1 \cdot t^{ \left( \frac{1}{2} \right)^{m - \nu - 1} } (1 + o(1)),
    \end{equation}
    где $\mathcal{M}$ --- некоторая константа, и
    \begin{equation*}
        U^{(1)} = (E - A_{11})^{-1} A_{12} \cdot \ldots \cdot (E - A_{\mu^*-1,\mu^*-1})^{-1} A_{\mu^*-1,\mu^*} u^{(\mu^*)},
    \end{equation*}
    если $K_{\mu^*}$ --- класс с наименьшим номером среди классов подцепочки $K_1, \ldots, K_\nu$, имеющих перронов корень, равный $1$.
\end{theorem}

\begin{thebibliography}{99}
    \bibitem{gantmaher}
        Гантмахер~Ф.Р. \textbf{Теория матриц.} --- 5-е изд., --- М.: ФИЗМАТЛИТ, 2010 --- 560 с. --- ISBN~978-5-9221-0524-8
    \bibitem{borisov-disser}
        Борисов~А.Е. Закономерности в словах стохастических контекстно-свободных языков, порождённых грамматиками с двумя классами нетерминальных символов. Вопросы экономного кодирования.
\end{thebibliography}

\end{document}
