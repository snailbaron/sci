\Title{О числе нетерминалов в деревьях вывода разложимой стохастической КС"=грамматики}{Мартынов~И.\,М.}
\OneAuthor{Мартынов Игорь Михайлович}{Нижегородский государственный университет им. Н.\,И.~Лобачевского}{murbidodrus@gmail.com}
	
В работе исследуются вероятностные свойства деревьев вывода высоты $t$ при $t \rightarrow \infty$ для стохастической КС"=грамматики. Случай, когда матрица первых моментов $A$ грамматики имеет перронов корень меньше $1$, был рассмотрен Л.П.~Жильцовой в \cite{lp-zakonom}. В данной работе эти результаты обобщаются на случай, когда перронов корень матрицы $A$ равен $1$, для грамматики произвольной структуры.

Стохастической КС"=грамматикой называется система $G = \left< V_N, V_N, R, s \right>$, где $V_T$ и $V_N$ "--- конечные алфавиты терминальных и нетерминальных символов соответственно, $s \in V_N$ "--- аксиома, $R = \cup_{i = 1}^k R_i$, где $k$ "--- мощность алфавита $V_N$ и $R_i$ "--- множество правил с одинкаовой левой частью вида
\begin{equation*}
    r_{ij} : A_i \xrightarrow{p_{ij}} \beta_{ij},\;j = 1,2,\ldots,n,
\end{equation*}
где $A_i \in V_N$, $\beta_{ij} \in (V_T \cup V_N)^*$ и $p_{ij}$ "--- вероятность применения правила $r_{ij}$, причём $0 < p_{ij} \leqslant 1$ и $\sum_{j = 1}^{n_i} p_{ij} = 1$.

Применение правила грамматики к слову состоит в замене вхождения нетерминала из левой части правила на слово, стоящее в его правой части.

Каждому слову $\alpha$ КС"=языка соответствует последовательность правил грамматики (вывод), с помощью которой $\alpha$ выводится из аксиомы $s$. Выводу слова соответствует дерево вывода, вероятность которого определяется как произведение вероятностей правил, образующих вывод.

По стохастической КС"=грамматике строится матрица $A$ первых моментов. Для неё элемент $a^i_j$ определяется как $\sum_{l = 1}^{n_i} p_{il} s_{il}^j$, где величина $s_{il}^j$ равна числу нетерминальных символов $A_j$ в правой части правила $r_{il}$. Перронов корень матрицы $A$ обозначим через $r$.

Введём некоторые обозначения. Будем говорить, что нетерминал $A_j$ непосредственно следует за нетерминалом $A_i$ (и обозначать $A_i \rightarrow A_j$), если в грамматике существует правило вида $A_i \xrightarrow{p_{il}} \alpha_1 A_j \alpha_2$, где $\alpha_1, \alpha_2 \in (V_T \cup V_N)^*$. Рефлексивное транзитивное замыкание отношения $\rightarrow$ обозначим $\rightarrow_*$.

Классом нетерминалов назовём максимальное по включению подмножество $K \in V_N$ такое, что $A_i \rightarrow_* A_j$ для любых $A_i, A_j \in K$. Для различных классов нетерминалов $K_1$ и $K_2$ будем говорить, что класс $K_2$ непосредственно следует за классом $K_1$ (и обозначать $K_1 \prec K_2$), если существуют $A_1 \in K_1$ и $A_2 \in K_2$, такие, что $A_1 \rightarrow A_2$. Рефлексивное транзитивное замыкание отношения $\prec$ обозначим через $\prec_*$.

Пусть $\mathcal{K} = \{ K_1, K_2, \ldots, K_m \}$ "--- множество классов нетерминалов грамматики, $m \geqslant 2$. Будем полагать, что классы нетерминалов перенумерованы таким образом, что $K_i \prec_* K_j$ тогда и только тогда, когда $i \leq j$.

В этом случае матрица первых моментов $A$ грамматики имеет следующий вид.
\begin{equation*}
\label{eq:matrix}
    A = 
    \begin{pmatrix}
        A_{11} & A_{12} & A_{13} & \cdots & A_{1,n-1} & A_{1,n} \\
        0 & A_{22} & A_{23} & \cdots & A_{2,n-1} & A_{2,n} \\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & 0 & \cdots & A_{n-1,n-1} & A_{n-1,n} \\
        0 & 0 & 0 & \cdots & 0 & A_{n,n}
    \end{pmatrix}
\end{equation*}
Один класс нетерминалов представлен в матрице множеством подряд идущих строк и соответствующим множеством столбцов с теми же номерами. Для класса $K_i$ квадратная подматрица, образованная соответствующими строками и столбцами, обозначается через $A_{ii}$. Подматрица $A_{ij}$ является нулевой, если $K_i \nprec K_j$. Блоки, расположенные ниже главной диагонали, нулевые в силу упорядоченности классов.

Для каждого класса $K_i$ матрица $A_{ii}$ неразложима. Без ограничения общности будем считать, что она строго положительна и непериодична. Обозначим через $r_i$ перронов корень матрицы $A_{ii}$. Для неразложимой матрицы перронов корень является вещественным и простым \cite{gantmaher}. Очевидно, $r = \max_i \{ r_i \}$. Классы $K_i$, перроновы корни $r_i$ которых равны $1$, будем называть критическими. Остальные классы грамматики будем называть докритическими.

Для каждого класса $K_i$ рассмотрим всевозможные цепочки классов $K_i, K_{j_1}, K_{j_2}, \ldots, K_{j_s}$ такие, что $K_i \prec K_{j_1}$ и $K_{j_k} \prec K_{j_{k+1}}$ для любого $k$ от $1$ до $s-1$. Каждая из таких цепочек содержит в себе некоторое число критических классов. Максимум числа критических классов по всем таким цепочкам обозначим $q_i$, а цепочки, на которых этот максимум достигается, будем называть насыщенными.

Через $P_j(t)$ обозначим вероятность множества деревьев вывода высоты $t$, корень которых помечен нетерминалом $A_j$.

\noindent
\hbox{\bf Теорема 1.}
{\it Формулировка теоремы.}
\begin{equation*}
	Q_i(t) \sim c_i \cdot t^{- \left( \frac{1}{2} \right)^{q_i}}
\end{equation*}
\begin{equation*}
	P_i(t) \sim c^*_i \cdot t^{ -1 - \left( \frac{1}{2} \right)^{q_i}}
\end{equation*}



\noindent
\hbox{\bf Теорема 2.}
{\it Формулировка теоремы.}
Пусть $r_j = 1$ для любого $j \in \{1,2,\ldots,m\}$. Пусть, кроме этого, в грамматике имеется некоторое правило $r_{ij}$, такое что $A_i \in K_\nu$. Тогда при $t \rightarrow \infty$ математическое ожидание числа применений правила $r_{ij}$ в деревьях вывода высоты $t$ выражается следующим образом:
\begin{equation*}
    M_{ij}(t) \sim d_i \cdot p_{ij} \cdot t^{ \left( \frac{1}{2} \right)^{\tilde{q} - 1} }
\end{equation*}
где $p_{ij}$ "--- вероятность правила $r_{ij}$, $c_i$ "--- некоторая константа, и
\begin{equation*}
 \tilde{q} = q_1 - (q^- + q^*)
\end{equation*}.

Таким образом, в цепочке, полностью состоящей из критических классов, асимптотика определяется удалённостью класса, в котором может применяться искомое правило ($K_\nu$ в обозначениях теоремы), от последнего класса цепочки. Если класс $K_\nu$ значительно удалён от конца цепочки, искомое правило применяется реже, так как высота $t$ дерева вывода достигается в большей степени за счёт применения правил из последующих классов. При приближении $K_\nu$ к концу цепочки, искомое правило применяется чаще, в силу большей разветвлённости дерева вывода ближе к его листьям, и большего содержания в нём нетерминалов из $K_\nu$.

\References
\begin{enumerate}[topsep=0pt,partopsep=0pt,label={[\arabic*]}]
\exhyphenpenalty=10000
\item
Жильцова~Л.\,П. Закономерности применения правил грамматики в выводах слов стохастического контекстно-свободного языка~// Математические вопросы кибернетики. Вып. 9. М.: Наука, 2000. С. 101-126
\item		
Гантмахер~Ф.Р. \textbf{Теория матриц.} "--- 5-е изд., "--- М.: ФИЗМАТЛИТ, 2010 "--- 560 с. "--- ISBN~978-5-9221-0524-8
\item
Борисов~А.\,Е. Закономерности в словах стохастических контекстно"=свободных языков, порождённых грамматиками с двумя классами нетерминальных символов. Вопросы экономного кодирования.
\end{enumerate}
